[experiment]
exp_name = "exp_ssl_pretrain-tcl-per_class_gmm-only_beamform-long_warmup"
tags = "efficientnetb0", "ssl", "image", "exp_ssl_pretrain", "tcl"
debug = false
seed = -1
train = true
test = false
use_comet_logger = true

[data]              # Data arguments
    [[general]]         # General shared arguments
    dsets = "sickkids_beamform"
    full_seq = false
    label_part = "plane"
    num_classes = 3

    [[dataloader]]      # Dataloader-related arguments
    batch_size = 32
    shuffle = true

    [[training]]        # Training-related arguments
    train_val_split = 0.75
    train_test_split = 0.75

    [[augment]]
    augment_training = true

[model]
    [[training]]          # General model training arguments
    stop_epoch = 200

    [[optim]]
    optimizer = "adamw"
    lr = 0.001
    weight_decay = 0.001
    grad_clip_norm = 1.0
    swa = false
    accum_batches = 1
    lr_scheduler = "cosine_annealing"

[ssl]               # Self-supervised pre-training specific arguments
self_supervised = true

    [[ssl_experiment]]
    ssl_model = "tcl"
    temperature = 1

    [[tcl_args]]        # TCL-specific arguments
    warmup_epochs = 30
    noise_gmm_type = "per_class"
