<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.scripts package &mdash; Renal View Labeling 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=8d563738"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="src.utils package" href="src.utils.html" />
    <link rel="prev" title="src.models package" href="src.models.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Renal View Labeling
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">src</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="src.html">src package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="src.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="src.data_prep.html">src.data_prep package</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.data_viz.html">src.data_viz package</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.loss.html">src.loss package</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.models.html">src.models package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">src.scripts package</a></li>
<li class="toctree-l4"><a class="reference internal" href="src.utils.html">src.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="src.html#module-src">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Renal View Labeling</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">src</a></li>
          <li class="breadcrumb-item"><a href="src.html">src package</a></li>
      <li class="breadcrumb-item active">src.scripts package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/src.scripts.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="src-scripts-package">
<h1>src.scripts package<a class="headerlink" href="#src-scripts-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-src.scripts.collect_results">
<span id="src-scripts-collect-results-module"></span><h2>src.scripts.collect_results module<a class="headerlink" href="#module-src.scripts.collect_results" title="Link to this heading"></a></h2>
<p>collect_results.py</p>
<dl class="simple">
<dt>Description: Used to get metric results for eval. models of multiple experiments</dt><dd><p>from the <cite>inference</cite> directory, and place them in an ordered table.</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.add_space_between_dsets">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">add_space_between_dsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['val',</span> <span class="pre">'test',</span> <span class="pre">'stanford',</span> <span class="pre">'uiowa',</span> <span class="pre">'chop']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#add_space_between_dsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.add_space_between_dsets" title="Link to this definition"></a></dt>
<dd><p>Add column of space between metrics from different dsets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_metrics</strong> (<em>pd.DataFrame</em>) – Each row contains evaluation metrics for multiple datasets for the same
experiment</p></li>
<li><p><strong>dsets</strong> (<em>list</em><em>, </em><em>optional</em>) – Evaluation datasets stored</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metrics table with added space between columns of different datasets</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.barplot_all_models">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">barplot_all_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prettified_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#barplot_all_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.barplot_all_models" title="Link to this definition"></a></dt>
<dd><p>Create a barplot of metrics with all models for ONE hospital.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prettified_metrics</strong> (<em>pd.Series</em>) – Each row is a distinct model with ONE string metric column
evaluated on one hospital for a particular label type. Indexed by model
name.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of y-axis, by default None.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axis</em><em>, </em><em>optional</em>) – If provided, draw plot into this Axis instead of creating a new Axis, by
default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Grouped bar plot with custom confidence intervals</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.Axis.axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.compute_r2_scores_between_dsets">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">compute_r2_scores_between_dsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plane'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#compute_r2_scores_between_dsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.compute_r2_scores_between_dsets" title="Link to this definition"></a></dt>
<dd><p>Compute R2 scores on model performance between evaluation datasets.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is to see if good model performance on 1 dataset implies good model
performance on other datasets.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_metrics</strong> (<em>pd.DataFrame</em>) – Each row is a distinct model with a string metric column for each
dataset evaluated on.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>optional</em>) – Prediction task (side/plane). Corresponding metric columns end with
“_TASK”, by default “plane”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.create_eval_model_dir">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">create_eval_model_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#create_eval_model_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.create_eval_model_dir" title="Link to this definition"></a></dt>
<dd><p>Given the experiment name and evaluation task, create the path to the
expected directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>task</strong> (<em>str</em>) – Task (side/plane/None) to find models for</p></li>
<li><p><strong>dset</strong> (<em>str</em>) – Dataset split and/or external dataset evaluated on</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full path to existing evaluation model directory</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.get_eval_metrics">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">get_eval_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['val',</span> <span class="pre">'test',</span> <span class="pre">'stanford',</span> <span class="pre">'uiowa',</span> <span class="pre">'chop']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tasks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['side',</span> <span class="pre">'plane']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_bladder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#get_eval_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.get_eval_metrics" title="Link to this definition"></a></dt>
<dd><p>Get accuracy metrics for task-specific evaluation model, for the specified
experiment and evaluation datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dsets</strong> (<em>list</em><em>, </em><em>optional</em>) – Dataset splits and/or external datasets evaluated on, by default DSETS</p></li>
<li><p><strong>tasks</strong> (<em>list</em><em>, </em><em>optional</em>) – List of tasks (side/plane/None) to find models for, by default TASKS</p></li>
<li><p><strong>ignore_bladder</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, specify to ignore the images labeled as Bladder (if possible)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Row corresponding to evaluation datasets for 1 experiment</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.init">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.init" title="Link to this definition"></a></dt>
<dd><p>Initialize ArgumentParser object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parser</strong> (<em>argparse.ArgumentParser</em>) – ArgumentParser object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.main">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.main" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Perform the following:</dt><dd><ol class="arabic simple">
<li><p>Get results of evaluation models for each experiment, and</p></li>
<li><p>Store them in a CSV file</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>argparser.Namespace</em>) – Parsed arguments</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.parse_all_prettified_metric_cols">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">parse_all_prettified_metric_cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_prettified_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plane'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#parse_all_prettified_metric_cols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.parse_all_prettified_metric_cols" title="Link to this definition"></a></dt>
<dd><p>Given metrics for 1+ models on 1+ eval. datasets only for the given task,
and set index to experiment name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_prettified_metrics</strong> (<em>pd.DataFrame</em>) – Each row is a distinct model with a string metric column for each
dataset evaluated on.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>optional</em>) – Prediction task (side/plane). Corresponding metric columns end with
“_TASK”, by default “plane”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Each row is for a unique model and contains its performance metrics on
each eval. dataset. And the rows are indexed by experiment name.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.parse_prettified_metric_col">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">parse_prettified_metric_col</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#parse_prettified_metric_col"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.parse_prettified_metric_col" title="Link to this definition"></a></dt>
<dd><p>Given a (prettified) metric column, extract the mean metric value, lower CI
and upper CI values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>metric_col</strong> (<em>pd.Series</em><em>, </em><em>np.array</em><em>, </em><em>list</em>) – Metric string column of the form: “MEAN [LOWER, UPPER]”</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of MEAN, list of LOWER CI and list of UPPER CI values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of (np.array, np.array, np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.plot_all_models_on_dsets">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">plot_all_models_on_dsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plane'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'barplot.png'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#plot_all_models_on_dsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.plot_all_models_on_dsets" title="Link to this definition"></a></dt>
<dd><p>For each eval. dataset, create a barplot of performance metrics for all
models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_metrics</strong> (<em>pd.DataFrame</em>) – Each row is a distinct model with a string metric column for each
dataset evaluated on.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>optional</em>) – Prediction task (side/plane). Corresponding metric columns end with
“_TASK”, by default “plane”.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save plot to file, by default False.</p></li>
<li><p><strong>save_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory to save plot in, working directory by default.</p></li>
<li><p><strong>fname</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename to save plot as, by default ‘barplot.png’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Grouped bar plot with custom confidence intervals</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.Axis.axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.collect_results.prettify_metric">
<span class="sig-prename descclassname"><span class="pre">src.scripts.collect_results.</span></span><span class="sig-name descname"><span class="pre">prettify_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/collect_results.html#prettify_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.collect_results.prettify_metric" title="Link to this definition"></a></dt>
<dd><p>Given metric string of form: “0.6921 (0.681, 0.791)”, return the following
string: “69.21 [68.1, 79.1]”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>metric_str</strong> (<em>str</em>) – Metric string with confidence intervals</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Prettified metric string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.scripts.embed">
<span id="src-scripts-embed-module"></span><h2>src.scripts.embed module<a class="headerlink" href="#module-src.scripts.embed" title="Link to this heading"></a></h2>
<p>embed.py</p>
<p>Description: Contains function to extract embeddings from pretrained models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.scripts.embed.ImageEmbedder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.scripts.embed.</span></span><span class="sig-name descname"><span class="pre">ImageEmbedder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#ImageEmbedder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.ImageEmbedder" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class used to create image embeddings</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.embed.ImageEmbedder.embed">
<span class="sig-name descname"><span class="pre">embed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#ImageEmbedder.embed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.ImageEmbedder.embed" title="Link to this definition"></a></dt>
<dd><p>Embed images specified in a dataframe, directory or image dataloader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>save_path</strong> (<em>str</em>) – Path to save embeddings to</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedded features</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.embed.ImageEmbedder.embed_tf_batch">
<span class="sig-name descname"><span class="pre">embed_tf_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dataloader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#ImageEmbedder.embed_tf_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.ImageEmbedder.embed_tf_batch" title="Link to this definition"></a></dt>
<dd><p>Extract embeddings for all images in the directory, using Tensorflow
data loading libraries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_path</strong> (<em>str</em>) – File path to save embeddings at. Saved as h5 file.</p></li>
<li><p><strong>img_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to directory containing images, by default None.</p></li>
<li><p><strong>img_dataloader</strong> (<em>torch.utils.data.DataLoader</em>) – Image dataloader with metadata dictionary containing <cite>filename</cite>, by
default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains a column for the path to the image file. Other columns are
embedding columns</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.embed.ImageEmbedder.embed_torch">
<span class="sig-name descname"><span class="pre">embed_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#ImageEmbedder.embed_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.ImageEmbedder.embed_torch" title="Link to this definition"></a></dt>
<dd><p>Extract embeddings for image, using a PyTorch model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Image tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1280-dimensional embedding</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.embed.ImageEmbedder.embed_torch_batch">
<span class="sig-name descname"><span class="pre">embed_torch_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dataloader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#ImageEmbedder.embed_torch_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.ImageEmbedder.embed_torch_batch" title="Link to this definition"></a></dt>
<dd><p>Extract embeddings for all images in the directory, using PyTorch
libraries.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One of (img_dir, img_dataloader) must be specified!</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_path</strong> (<em>str</em>) – File path to save embeddings at. Saved as h5 file.</p></li>
<li><p><strong>img_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to directory containing images, by default None.</p></li>
<li><p><strong>img_dataloader</strong> (<em>torch.utils.data.DataLoader</em><em>, </em><em>optional</em>) – Image dataloader with metadata dictionary containing <cite>filename</cite>, by
default None</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device to send data to, by default constants.DEVICE.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains a column for the path to the image file. Other columns are
embedding columns</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.embed.extract_embeds">
<span class="sig-prename descclassname"><span class="pre">src.scripts.embed.</span></span><span class="sig-name descname"><span class="pre">extract_embeds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_embed_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">embedder_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#extract_embeds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.extract_embeds" title="Link to this definition"></a></dt>
<dd><p>Given a Tensorflow/Torch model, extract features from</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>img_file, img_dir and img_dataloader cannot both be empty.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.Model</em><em> or </em><em>torch.nn.Module</em>) – Pretrained model</p></li>
<li><p><strong>save_embed_path</strong> (<em>str</em><em>, </em><em>optional</em>) – If path provided, stores embeddings at path, by default None.</p></li>
<li><p><strong>exp_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of experiment. Can be used to generate <cite>save_embed_path</cite>, if it’s
not provided, by default None.</p></li>
<li><p><strong>img_file</strong> (<em>str</em>) – Path to image file</p></li>
<li><p><strong>img_dir</strong> (<em>str</em>) – Path to directory of images</p></li>
<li><p><strong>img_dataloader</strong> (<em>torch.utils.data.DataLoader</em>) – Image dataloader with metadata dictionary containing <cite>filename</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.embed.get_embeds">
<span class="sig-prename descclassname"><span class="pre">src.scripts.embed.</span></span><span class="sig-name descname"><span class="pre">get_embeds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#get_embeds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.get_embeds" title="Link to this definition"></a></dt>
<dd><p>Retrieve extracted deep embeddings using model specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em><em> or </em><em>list</em>) – Model/experiment name, or list of model/experiment names to concatenate
embeddings.</p></li>
<li><p><strong>**kwargs</strong> (Keyword arguments for <cite>get_save_path</cite>) – raw : bool, optional
segmented : bool, optional
reverse_mask : bool, optional</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.embed.get_save_path">
<span class="sig-prename descclassname"><span class="pre">src.scripts.embed.</span></span><span class="sig-name descname"><span class="pre">get_save_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segmented</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#get_save_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.get_save_path" title="Link to this definition"></a></dt>
<dd><p>Create expected save path from model name and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Model/Experiment name</p></li>
<li><p><strong>dset</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of dataset (e.g., sickkids)</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Specific data split (i.e., train/val/test)</p></li>
<li><p><strong>raw</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, extracts embeddings for raw images. Otherwise, uses
preprocessed images, by default False.</p></li>
<li><p><strong>segmented</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, extracts embeddings for segmented images, by default False.</p></li>
<li><p><strong>reverse_mask</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, reverses mask for segmented images, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full path to save embeddings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.embed.init">
<span class="sig-prename descclassname"><span class="pre">src.scripts.embed.</span></span><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.init" title="Link to this definition"></a></dt>
<dd><p>Initialize ArgumentParser arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parser</strong> (<em>argparse.ArgumentParser</em>) – ArgumentParser object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.embed.main">
<span class="sig-prename descclassname"><span class="pre">src.scripts.embed.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/embed.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.embed.main" title="Link to this definition"></a></dt>
<dd><p>Extract embeddings for the following experiments and datasets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>argparse.Namespace</em>) – Contains command-line arguments</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.scripts.grid_search">
<span id="src-scripts-grid-search-module"></span><h2>src.scripts.grid_search module<a class="headerlink" href="#module-src.scripts.grid_search" title="Link to this heading"></a></h2>
<p>grid_search.py</p>
<p>Description: Used to perform hyperparameter search via RandomizedGridSearch</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.scripts.grid_search.GridSearch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.scripts.grid_search.</span></span><span class="sig-name descname"><span class="pre">GridSearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_search_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'loss'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#GridSearch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.GridSearch" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation of RandomizedGridSearchCV.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.grid_search.GridSearch.find_best_models">
<span class="sig-name descname"><span class="pre">find_best_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#GridSearch.find_best_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.GridSearch.find_best_models" title="Link to this definition"></a></dt>
<dd><p>Get row with the best validation metric. If cross-fold validation done,
average metrics over folds.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Containing the best validation set results, where each row
corresponds to tested model hyperparameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.grid_search.GridSearch.get_tested_hyperparams">
<span class="sig-name descname"><span class="pre">get_tested_hyperparams</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#GridSearch.get_tested_hyperparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.GridSearch.get_tested_hyperparams" title="Link to this definition"></a></dt>
<dd><p>Gets all tested hyperparameter combinations so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Contains hyperparameters on each row</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.grid_search.GridSearch.get_training_dirs">
<span class="sig-name descname"><span class="pre">get_training_dirs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#GridSearch.get_training_dirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.GridSearch.get_training_dirs" title="Link to this definition"></a></dt>
<dd><p>Find all directories made during hyperparameter search. Move to grid
search directory if not already done.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All folders containing the model name will be moved into the grid search
directory.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Absolute paths to each directory in the grid search directory</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.grid_search.GridSearch.is_hyperparam_used">
<span class="sig-name descname"><span class="pre">is_hyperparam_used</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_hyperparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#GridSearch.is_hyperparam_used"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.GridSearch.is_hyperparam_used" title="Link to this definition"></a></dt>
<dd><p>Checks if sampled hyperparams have already been tested</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If True, hyperparameters have already been tested. Otherwise, False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.grid_search.GridSearch.perform_grid_search">
<span class="sig-name descname"><span class="pre">perform_grid_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#GridSearch.perform_grid_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.GridSearch.perform_grid_search" title="Link to this definition"></a></dt>
<dd><p>Performs randomized grid search on given specified parameter lists.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tested parameter combinations are saved.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>search_space</strong> (<em>dict</em>) – Keys are argument names for training script and values are potential
values to search.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – Number of trials to run</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.grid_search.GridSearch.sample_hyperparams">
<span class="sig-name descname"><span class="pre">sample_hyperparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">possible_hyperparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#GridSearch.sample_hyperparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.GridSearch.sample_hyperparams" title="Link to this definition"></a></dt>
<dd><p>Randomly choose hyperparameter combinations that is unused.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mapping of argument to hyperparameter value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.scripts.grid_search.GridSearch.save_grid_search_results">
<span class="sig-name descname"><span class="pre">save_grid_search_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#GridSearch.save_grid_search_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.GridSearch.save_grid_search_results" title="Link to this definition"></a></dt>
<dd><p>Saves the best hyperparameters to a JSON file, and saves a summary of
model metrics in a CSV file.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.grid_search.aggregate_fold_histories">
<span class="sig-prename descclassname"><span class="pre">src.scripts.grid_search.</span></span><span class="sig-name descname"><span class="pre">aggregate_fold_histories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#aggregate_fold_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.aggregate_fold_histories" title="Link to this definition"></a></dt>
<dd><p>Averages the metric of interest for each epoch, across folds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>result_dir</strong> (<em>str</em>) – Path to model training directory</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains the averaged values per epoch</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.grid_search.get_hyperparams">
<span class="sig-prename descclassname"><span class="pre">src.scripts.grid_search.</span></span><span class="sig-name descname"><span class="pre">get_hyperparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/grid_search.html#get_hyperparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.grid_search.get_hyperparams" title="Link to this definition"></a></dt>
<dd><p>Get hyperparameters from a training directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Contains hyperparameters from run</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.scripts.load_data">
<span id="src-scripts-load-data-module"></span><h2>src.scripts.load_data module<a class="headerlink" href="#module-src.scripts.load_data" title="Link to this heading"></a></h2>
<p>load_data.py</p>
<p>Description: Contains utility functions for instantiating DataModule objects.</p>
<p>Note: <cite>hparams</cite> is a direct dependence on arguments in <cite>model_training.py</cite>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_data.create_dataloader_from_metadata_table">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_data.</span></span><span class="sig-name descname"><span class="pre">create_dataloader_from_metadata_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overwrite_hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_data.html#create_dataloader_from_metadata_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_data.create_dataloader_from_metadata_table" title="Link to this definition"></a></dt>
<dd><p>Given a metadata table, create a DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_metadata</strong> (<em>pandas.DataFrame</em>) – Metadata table containing necessary data for image loading</p></li>
<li><p><strong>hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Experiment hyperparameters. If not provided, resort to defaults.</p></li>
<li><p><strong>dataloader_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – DataLoader parameters. If not provided, resort to defaults.</p></li>
<li><p><strong>**overwrite_hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to overwrite experiment hyperparameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_data.create_eval_hparams">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_data.</span></span><span class="sig-name descname"><span class="pre">create_eval_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_data.html#create_eval_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_data.create_eval_hparams" title="Link to this definition"></a></dt>
<dd><p>Create hyperparameters to evaluate on a data split (typically test)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dset</strong> (<em>str</em>) – If provided, filter by dataset name</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Data split, by default “test”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains hyperparameters to overwrite, if necessary</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_data.setup_data_module">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_data.</span></span><span class="sig-name descname"><span class="pre">setup_data_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_defaults</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overwrite_hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_data.html#setup_data_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_data.setup_data_module" title="Link to this definition"></a></dt>
<dd><p>Set up data module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>dict</em>) – Experiment hyperparameters</p></li>
<li><p><strong>img_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to directory containing images, by default image directory
corresponding to hospital (if any).</p></li>
<li><p><strong>use_defaults</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, start from default hyperparameters. Defaults to False.</p></li>
<li><p><strong>full_path</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, <cite>filename</cite> in metadata dicts is a full path. Defaults to False.</p></li>
<li><p><strong>**overwrite_hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to overwrite <cite>hparams</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lightning.pytorch.LightningDataModule</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_data.setup_default_data_module_for_dset">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_data.</span></span><span class="sig-name descname"><span class="pre">setup_default_data_module_for_dset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_data.html#setup_default_data_module_for_dset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_data.setup_default_data_module_for_dset" title="Link to this definition"></a></dt>
<dd><p>Get image dataloader for dataset split/name specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dset</strong> (<em>str</em>) – Name of dataset</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of data split</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for <cite>setup_data_module</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Each batch returns images and a dict containing metadata</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lightning.pytorch.DataModule</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_data.setup_default_dataloader_for_dset">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_data.</span></span><span class="sig-name descname"><span class="pre">setup_default_dataloader_for_dset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overwrite_hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_data.html#setup_default_dataloader_for_dset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_data.setup_default_dataloader_for_dset" title="Link to this definition"></a></dt>
<dd><p>Create DataLoader for specific dataset and train/val/test split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dset</strong> (<em>str</em>) – Name of dataset</p></li>
<li><p><strong>split</strong> (<em>str</em>) – Name of data split</p></li>
<li><p><strong>filters</strong> (<em>dict</em><em>, </em><em>optional</em>) – Mapping of column name to allowed value/s</p></li>
<li><p><strong>**overwrite_hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to overwrite hyperparameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.scripts.load_model">
<span id="src-scripts-load-model-module"></span><h2>src.scripts.load_model module<a class="headerlink" href="#module-src.scripts.load_model" title="Link to this heading"></a></h2>
<p>load_model.py</p>
<p>Description: Contains utility functions for instantiating model classes/objects.</p>
<p>Note: <cite>hparams</cite> is a direct dependence on arguments in <cite>model_training.py</cite>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.create_conv_backbone">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">create_conv_backbone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#create_conv_backbone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.create_conv_backbone" title="Link to this definition"></a></dt>
<dd><p>Return base EfficientNet convolutional backbone, based on parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hparams</strong> (<em>dict</em>) – Experiment parameters</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>EfficientNet convolutional backbone</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.drop_weights_containing">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">drop_weights_containing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">substr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#drop_weights_containing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.drop_weights_containing" title="Link to this definition"></a></dt>
<dd><p>Drop weights containing specific substring</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dict</strong> (<em>dict</em>) – Model state dict for a torch.nn.Module object</p></li>
<li><p><strong>substr</strong> (<em>str</em>) – Substring of weights to drop</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Modified state dict</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.extract_backbone_dict_from_efficientnet_model">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">extract_backbone_dict_from_efficientnet_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#extract_backbone_dict_from_efficientnet_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.extract_backbone_dict_from_efficientnet_model" title="Link to this definition"></a></dt>
<dd><p>Given an EfficientNet model instance, extract conv. (and temporal) backbones
into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>torch.nn.Module</em>) – Must be an EfficientNet model</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains “conv_backbone” and optionally “temporal_backbone”</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.extract_backbone_dict_from_ssl_model">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">extract_backbone_dict_from_ssl_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#extract_backbone_dict_from_ssl_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.extract_backbone_dict_from_ssl_model" title="Link to this definition"></a></dt>
<dd><p>Given SSL-pretrained model instance, extract conv. (and temporal) backbones
into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>torch.nn.Module</em>) – Must contain “conv_backbone” (and “temporal_backbone”) attributes.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains “conv_backbone” and optionally “temporal_backbone”</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.extract_backbones_from_ssl">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">extract_backbones_from_ssl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_cls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#extract_backbones_from_ssl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.extract_backbones_from_ssl" title="Link to this definition"></a></dt>
<dd><p>Given experiment hyperparameters with 1+ specified SSL checkpoints, extract
their conv. backbone and temporal backbone, if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>dict</em>) – Experiment parameters, containing 1+ SSL-pretrained model ckpt paths</p></li>
<li><p><strong>model_cls</strong> (<em>class</em>) – Reference to model class, of type torch.nn.Module</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains mapping of name to backbones (conv_backbone or
temporal_backbone)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.extract_backbones_from_ssl_single">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">extract_backbones_from_ssl_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_cls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#extract_backbones_from_ssl_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.extract_backbones_from_ssl_single" title="Link to this definition"></a></dt>
<dd><p>Given experiment hyperparameters for 1 SSL-pretrained model, extract its
conv. backbone and temporal backbone, if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>dict</em>) – Experiment parameters</p></li>
<li><p><strong>model_cls</strong> (<em>class</em>) – Reference to model class of type torch.nn.Module</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains mapping of name to backbones (conv_backbone or
temporal_backbone)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.find_best_ckpt_path">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">find_best_ckpt_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_exp_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#find_best_ckpt_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.find_best_ckpt_path" title="Link to this definition"></a></dt>
<dd><p>Finds the path to the best model checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_exp_dir</strong> (<em>str</em>) – Path to a trained model directory</p></li>
<li><p><strong>exp_name</strong> (<em>str</em>) – Experiment name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to PyTorch Lightning best model checkpoint</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If no valid ckpt files found</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.find_last_ckpt_path">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">find_last_ckpt_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_exp_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#find_last_ckpt_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.find_last_ckpt_path" title="Link to this definition"></a></dt>
<dd><p>Finds the path to the last model checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_exp_dir</strong> (<em>str</em>) – Path to a trained model directory</p></li>
<li><p><strong>exp_name</strong> (<em>str</em>) – Experiment name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to PyTorch Lightning last model checkpoint</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If no valid ckpt files found</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.find_layers_in_model">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">find_layers_in_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#find_layers_in_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.find_layers_in_model" title="Link to this definition"></a></dt>
<dd><p>Find specified layers in model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Model</p></li>
<li><p><strong>layer_type</strong> (<em>class</em>) – Class of layer desired</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of model indices containing layer</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.get_exp_dir">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">get_exp_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#get_exp_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.get_exp_dir" title="Link to this definition"></a></dt>
<dd><p>Get experiment directory, given experiment name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Experiment name</p></li>
<li><p><strong>on_error</strong> (<em>str</em><em>, </em><em>optional</em>) – If “raise”, raises an error, if expected directory does not exist. If
“ignore”, simply returns None, by default “raise”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to experiment directory, where model was trained</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.get_hyperparameters">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">get_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparam_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hparams.yaml'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'use_default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#get_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.get_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Load hyperparameters from model training directory. If not provided, return
default hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparam_dir</strong> (<em>str</em>) – Path to model training directory containing hyperparameters.</p></li>
<li><p><strong>exp_name</strong> (<em>str</em><em>, </em><em>optional</em>) – If <cite>hparam_dir</cite> not provided but <cite>exp_name</cite> is, use to find model
directory, by default None.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of YAML file with hyperparameters, by default “hparams.yaml”</p></li>
<li><p><strong>on_error</strong> (<em>str</em><em>, </em><em>optional</em>) – If “use_default”, return default hyperparameters. If “raise”, raises
error, by default “use_default”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hyperparameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.get_last_conv_layer">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">get_last_conv_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#get_last_conv_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.get_last_conv_layer" title="Link to this definition"></a></dt>
<dd><p>Get last convolutional layer in model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>torch.nn.Module</em>) – Convolutional model</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Last convolutional layer</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Conv2d</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.get_model_cls">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">get_model_cls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#get_model_cls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.get_model_cls" title="Link to this definition"></a></dt>
<dd><p>Given experiment hyperparameters, get appropriate model class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adds <cite>backbone</cite> to hparams, if needed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hparams</strong> (<em>dict</em>) – Experiment parameters</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model class, and dict of keyword arguments needed to instantiate class</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of (class, dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.load_model">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.load_model" title="Link to this definition"></a></dt>
<dd><p>Given experiment hyperparameters, instantiate/load model specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hparams</strong> (<em>dict</em>) – Experiment hyperparameters</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Desired model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.load_pretrained_from_exp_name">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">load_pretrained_from_exp_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ckpt_option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overwrite_hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#load_pretrained_from_exp_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.load_pretrained_from_exp_name" title="Link to this definition"></a></dt>
<dd><p>Load pretrained model from experiment name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>ckpt_option</strong> (<em>str</em>) – Choice of “best” checkpoint (based on validation set) or “last”
checkpoint file, by default “best”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pretrained model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.overwrite_model">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">overwrite_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_state_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#overwrite_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.overwrite_model" title="Link to this definition"></a></dt>
<dd><p>Given a (new) model, overwrite its existing parameters based on a source
model or its provided state dict.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One of <cite>src_model</cite> or <cite>src_state_dict</cite> must be provided.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst_model</strong> (<em>torch.nn.Module</em>) – Model whose weights to overwrite</p></li>
<li><p><strong>src_model</strong> (<em>torch.nn.Module</em><em>, </em><em>optional</em>) – Pretrained model whose weights to use in overwriting, by default None</p></li>
<li><p><strong>src_state_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Pretrained model’s state dict, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model whose weights were overwritten (in-place)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.prepend_prefix">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">prepend_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_regex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#prepend_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.prepend_prefix" title="Link to this definition"></a></dt>
<dd><p>Given a state dict, prepend prefix to every weight name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dict</strong> (<em>dict</em>) – Model state dict for a torch.nn.Module object</p></li>
<li><p><strong>prefix</strong> (<em>str</em>) – Prefix to prepend to each weight name</p></li>
<li><p><strong>exclude_regex</strong> (<em>str</em><em>, </em><em>optional</em>) – Regex for weights to exclude, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Modified state dict</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.remove_prefix">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">remove_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#remove_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.remove_prefix" title="Link to this definition"></a></dt>
<dd><p>Given a state dict, remove prefix from every weight name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dict</strong> (<em>dict</em>) – Model state dict for a torch.nn.Module object</p></li>
<li><p><strong>prefix</strong> (<em>str</em>) – Prefix to remove from each weight name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Modified state dict</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.load_model.rename_torch_module">
<span class="sig-prename descclassname"><span class="pre">src.scripts.load_model.</span></span><span class="sig-name descname"><span class="pre">rename_torch_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/load_model.html#rename_torch_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.load_model.rename_torch_module" title="Link to this definition"></a></dt>
<dd><p>Rename module in a saved model checkpoint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ckpt_path</strong> (<em>str</em>) – Path to PyTorch Lightning checkpoint file</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="src-scripts-model-applied-eval-module">
<h2>src.scripts.model_applied_eval module<a class="headerlink" href="#src-scripts-model-applied-eval-module" title="Link to this heading"></a></h2>
</section>
<section id="module-src.scripts.model_eval">
<span id="src-scripts-model-eval-module"></span><h2>src.scripts.model_eval module<a class="headerlink" href="#module-src.scripts.model_eval" title="Link to this heading"></a></h2>
<p>model_eval.py</p>
<dl class="simple">
<dt>Description: Used to evaluate a trained model’s performance on other view</dt><dd><p>labeling datasets.</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.analyze_dset_preds">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">analyze_dset_preds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_to_comet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">infer_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#analyze_dset_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.analyze_dset_preds" title="Link to this definition"></a></dt>
<dd><p>Analyze dset split predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dsets</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Name of dataset</p></li>
<li><p><strong>splits</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Specific split of dataset. One of (train/val/test)</p></li>
<li><p><strong>log_to_comet</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, log metrics and UMAPs to Comet ML.</p></li>
<li><p><strong>**infer_kwargs</strong> (<em>Keyword arguments</em>) – <dl class="simple">
<dt>Inference keyword arguments, which includes</dt><dd><dl class="simple">
<dt>mask_bladder<span class="classifier">bool, optional</span></dt><dd><p>If True, bladder predictions are masked out, by default False</p>
</dd>
<dt>test_time_aug<span class="classifier">bool, optional</span></dt><dd><p>If True, perform test-time augmentation.</p>
</dd>
</dl>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If <cite>exp_name</cite> does not lead to a valid training directory</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.bootstrap_metric">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">bootstrap_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_func=&lt;function</span> <span class="pre">accuracy_score&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col='label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_col='pred'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha=0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap=12000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#bootstrap_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.bootstrap_metric" title="Link to this definition"></a></dt>
<dd><p>Perform BCa bootstrap on table of predictions to calculate metric with a
bootstrapped confidence interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>metric_func</strong> (<em>function</em><em>, </em><em>optional</em>) – Reference to function that can be used to calculate a metric given the
(label, predictions), by default sklearn.metrics.accuracy_score</p></li>
<li><p><strong>label_col</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of label column, by default “label”</p></li>
<li><p><strong>pred_col</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of label column, by default “pred”</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Desired significance level, by default 0.05</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em><em>, </em><em>optional</em>) – Sample size for each bootstrap iteration</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output of <cite>func</cite> with 95% confidence interval ends</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of (exact, (lower_bound, upper_bound))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.calculate_accuracy">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">calculate_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pred'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#calculate_accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.calculate_accuracy" title="Link to this definition"></a></dt>
<dd><p>Given a table of predictions with columns “label” and “pred”, compute
accuracy rounded to 4 decimal places.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pd.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>label_col</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of label column, by default “label”</p></li>
<li><p><strong>pred_col</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of label column, by default “pred”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Accuracy rounded to 4 decimal places</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.calculate_exp_metrics">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">calculate_exp_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_to_comet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">infer_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#calculate_exp_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.calculate_exp_metrics" title="Link to this definition"></a></dt>
<dd><p>Given that inference was performed, compute metrics for experiment model
and dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of dataset</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Specific split of dataset. One of (train/val/test)</p></li>
<li><p><strong>hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Experiment hyperparameters, by default None</p></li>
<li><p><strong>log_to_comet</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, log metrics and graphs to Comet ML</p></li>
<li><p><strong>**infer_kwargs</strong> (<em>Keyword arguments</em>) – <dl class="simple">
<dt>Inference keyword arguments, which includes</dt><dd><dl class="simple">
<dt>mask_bladder<span class="classifier">bool, optional</span></dt><dd><p>If True, bladder predictions are masked out, by default False</p>
</dd>
<dt>test_time_aug<span class="classifier">bool, optional</span></dt><dd><p>If True, perform test-time augmentation.</p>
</dd>
</dl>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.calculate_hn_corr">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">calculate_hn_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#calculate_hn_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.calculate_hn_corr" title="Link to this definition"></a></dt>
<dd><p>Compute correlation between correct predictions and HN</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Correlation between correctly predicted label and HN</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.calculate_metric_by_groups">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">calculate_metric_by_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_func=&lt;function</span> <span class="pre">accuracy_score&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#calculate_metric_by_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.calculate_metric_by_groups" title="Link to this definition"></a></dt>
<dd><p>Group predictions by patient/sequence ID, calculate metric on each group
and get the average prediction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pd.DataFrame</em>) – Model predictions and labels</p></li>
<li><p><strong>group_cols</strong> (<em>list</em>) – List of columns in <cite>df_pred</cite> to group by</p></li>
<li><p><strong>metric_func</strong> (<em>function</em><em>, </em><em>optional</em>) – Reference to function that can be used to calculate a metric given the
(label, predictions), by default sklearn.metrics.accuracy_score</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains mean and standard deviation of calculated metric across groups</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.calculate_metrics">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">calculate_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">ci_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#calculate_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.calculate_metrics" title="Link to this definition"></a></dt>
<dd><p>Calculate important metrics given prediction and labels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pd.DataFrame</em>) – Model predictions and labels</p></li>
<li><p><strong>ci</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, add bootstrapped confidence interval, by default False.</p></li>
<li><p><strong>**ci_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to pass into <cite>bootstrap_metric</cite> if <cite>ci</cite> is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Table containing metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.calculate_per_seq_silhouette_score">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">calculate_per_seq_silhouette_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_part</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'side'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('None',)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#calculate_per_seq_silhouette_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.calculate_per_seq_silhouette_score" title="Link to this definition"></a></dt>
<dd><p>Calculate a per - ultrasound sequence Silhouette score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of dataset</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Specific split of dataset. One of (train/val/test)</p></li>
<li><p><strong>label_part</strong> (<em>str</em><em>, </em><em>optional</em>) – If specified, either <cite>side</cite> or <cite>plane</cite> is extracted from each label
and used as the given label, by default “side”</p></li>
<li><p><strong>exclude_labels</strong> (<em>list</em><em> or </em><em>array-like</em><em>, </em><em>optional</em>) – List of labels whose matching samples will be excluded when calculating
the Silhouette score, by default (“None”,)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mean Silhouette Score across unique ultrasound sequences</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.check_misclassifications">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">check_misclassifications</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#check_misclassifications"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.check_misclassifications" title="Link to this definition"></a></dt>
<dd><p>Given the most confident model predictions, determine the percentage of
misclassifications that are due to:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Swapping sides (e.g., Saggital Right mistaken for Saggital Left)</p></li>
<li><p>Adjacent views</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>filter</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, filters for most confident prediction in consecutive label
groups or for each of the 5 main views per sequence, by default True.</p></li>
<li><p><strong>local</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, gets the most confident prediction within each group of
consecutive images with the same label. Otherwise, aggregates by view
label to find the most confident view label predictions,
by default True.</p></li>
<li><p><strong>relative_side</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, assumes predicted labels are encoded for relative sides, by
default False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.check_others_pred_progression">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">check_others_pred_progression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#check_others_pred_progression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.check_others_pred_progression" title="Link to this definition"></a></dt>
<dd><p>Given model predictions for full sequences that include “Other” labels,
show (predicted) label progression for unlabeled images among real labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.check_rel_side_pred_progression">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">check_rel_side_pred_progression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#check_rel_side_pred_progression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.check_rel_side_pred_progression" title="Link to this definition"></a></dt>
<dd><p>Given model predictions for full sequences where side labels are relative
to the first side, show label/predicted label progression.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Highlight locations where error in toggling between first/second occurs.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.compare_prediction_similarity">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">compare_prediction_similarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_pred_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#compare_prediction_similarity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.compare_prediction_similarity" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>For each label, print Pearson correlation of:</dt><dd><ol class="arabic simple">
<li><p>predicted label with model 1 vs model 2</p></li>
<li><p>side predicted</p></li>
<li><p>view predicted</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred_1</strong> (<em>pandas.DataFrame</em>) – Inference on the same dset by model 1</p></li>
<li><p><strong>df_pred_2</strong> (<em>pandas.DataFrame</em>) – Inference on the same dset by model 2</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.create_save_dir_by_flags">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">create_save_dir_by_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_flags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#create_save_dir_by_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.create_save_dir_by_flags" title="Link to this definition"></a></dt>
<dd><p>Create directory to save dset predictions, based on experiment name and
keyword arguments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of dataset</p></li>
<li><p><strong>**extra_flags</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments, specifying extra flags used during inference</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expected directory to save dset predictions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.create_save_path">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">create_save_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_flags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#create_save_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.create_save_path" title="Link to this definition"></a></dt>
<dd><p>Create file path to dset predictions, based on experiment name and keyword
arguments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of dataset</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Specific split of dataset. One of (train/val/test)</p></li>
<li><p><strong>**extra_flags</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments, specifying extra flags used during inference</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expected path to dset predictions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.embed_dset">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">embed_dset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overwrite_hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#embed_dset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.embed_dset" title="Link to this definition"></a></dt>
<dd><p>Extract embeddings on dset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of dataset</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Specific split of dataset. One of (train/val/test)</p></li>
<li><p><strong>overwrite_existing</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True and embeddings already exists, overwrite existing, by
default OVERWRITE_EXISTING.</p></li>
<li><p><strong>overwrite_hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to overwrite experiment hyperparameters</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If <cite>exp_name</cite> does not lead to a valid training directory</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.eval_calculate_all_metrics">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">eval_calculate_all_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#eval_calculate_all_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.eval_calculate_all_metrics" title="Link to this definition"></a></dt>
<dd><p>Calculates all eval. metrics in a proper table format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Table of formatted metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.eval_create_plots">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">eval_create_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comet_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#eval_create_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.eval_create_plots" title="Link to this definition"></a></dt>
<dd><p>Visual evaluation of model performance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>hparams</strong> (<em>dict</em>) – Keyword arguments for experiment hyperparameters</p></li>
<li><p><strong>inference_dir</strong> (<em>str</em>) – Path to experiment-specific inference directory</p></li>
<li><p><strong>dset</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of dataset</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Specific split of dataset. One of (train/val/test)</p></li>
<li><p><strong>comet_logger</strong> (<em>comet_ml.ExistingExperiment</em>) – If provided, log figures to Comet ML</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.extract_from_label">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">extract_from_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plane'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#extract_from_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.extract_from_label" title="Link to this definition"></a></dt>
<dd><p>Creates a new column called “&lt;col&gt;_&lt;extract&gt;”, made from extracting data
from a column of label/predicted label strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Contains &lt;col&gt; column with strings of the form &lt;plane&gt;_&lt;side&gt;</p></li>
<li><p><strong>col</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of column of strings, by default “label”</p></li>
<li><p><strong>extract</strong> (<em>str</em><em>, </em><em>optional</em>) – What to extract. One of “plane” or “side”, by default “plane”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.filter_most_confident">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">filter_most_confident</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pred'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#filter_most_confident"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.filter_most_confident" title="Link to this definition"></a></dt>
<dd><p>Given predictions for all images across multiple US sequences, filter the
prediction with the highest confidence (based on output activation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>local</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, gets the most confident prediction within each group of
consecutive images with the same label. Otherwise, aggregates by
predicted view label to find the most confident view label predictions,
by default False.</p></li>
<li><p><strong>top_k</strong> (<em>int</em><em>, </em><em>optional</em>) – Get top K most confident view label predictions, by default 1.</p></li>
<li><p><strong>groupby</strong> (<em>str</em><em>, </em><em>optional</em>) – If <cite>local=False</cite>, “pred” would find the most confident view prediction
(irrespective of the ground truth), and “label” would find the most
confident prediction grouping by the ground-truth label</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered predictions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.get_da_transform">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">get_da_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da_transform_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_paths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#get_da_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.get_da_transform" title="Link to this definition"></a></dt>
<dd><p>Return domain adaptation (DA) transform</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensures that it’s converted to a PyTorch tensor post-transform</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da_transform_name</strong> (<em>str</em>) – Name of DA transform</p></li>
<li><p><strong>src_paths</strong> (<em>list</em>) – List of source dataset paths</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Composed DA transform</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>albumentations.Compose</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.get_highest_loss_samples">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">get_highest_loss_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#get_highest_loss_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.get_highest_loss_samples" title="Link to this definition"></a></dt>
<dd><p>Get predicted samples with the highest loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pd.DataFrame</em>) – Each row is a prediction</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples per label</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Table with sampled highest losses per label</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.get_local_groups">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">get_local_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#get_local_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.get_local_groups" title="Link to this definition"></a></dt>
<dd><p>Identify local groups of consecutive labels/predictions in a list of values.
Return a list of increasing integers which identify these groups.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Input of [1, 1, 2, 1, 1] would return [1, 1, 2, 3, 3]. Groupings would be:</dt><dd><ul class="simple">
<li><p>Group 1: (1, 1)</p></li>
<li><p>Group 2: (2)</p></li>
<li><p>Group 3: (1, 1)</p></li>
</ul>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>list</em>) – List of values in some sequential order</p></li>
<li><p><strong>col</strong> (<em>str</em>) – Name of column to check for consecutive values</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Increasing integer values, which represent each local group of
images with the same label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.get_new_seq_numbers">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">get_new_seq_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#get_new_seq_numbers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.get_new_seq_numbers" title="Link to this definition"></a></dt>
<dd><p>Since sequence numbers are not all present (due to unlabeled images), create
new sequence numbers from order of existing images in the sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_pred</strong> (<em>pd.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>df_pred with added column “seq_number_new”</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.identify_repeating_same_label_in_video">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">identify_repeating_same_label_in_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#identify_repeating_same_label_in_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.identify_repeating_same_label_in_video" title="Link to this definition"></a></dt>
<dd><p>Given predictions on US videos, identify images which have consecutive
images with the same label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>repeating</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, filter for repeating same label frames. Otherwise, filter for
frames that are NOT adjacent to frames of the same label, by default
True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean mask to keep images that ARE or ARE NOT adjacent to
same-label image frames</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.identify_repeating_segments">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">identify_repeating_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#identify_repeating_segments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.identify_repeating_segments" title="Link to this definition"></a></dt>
<dd><p>Create boolean mask, where True is given to list values adjacent to the same
value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<em>list</em>) – List of values</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean mask of repeating value segments</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.infer_dset">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">infer_dset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_number_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_bladder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_time_aug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">da_transform_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overwrite_hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#infer_dset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.infer_dset" title="Link to this definition"></a></dt>
<dd><p>Perform inference on dset, and saves results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of dataset</p></li>
<li><p><strong>split</strong> (<em>str</em><em>, </em><em>optional</em>) – Specific split of dataset. One of (train/val/test)</p></li>
<li><p><strong>seq_number_limit</strong> (<em>int</em><em>, </em><em>optional</em>) – If provided, filters out dset split samples with sequence numbers higher
than this value, by default None.</p></li>
<li><p><strong>mask_bladder</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, mask out predictions on bladder/middle side, leaving only
kidney labels. Defaults to False.</p></li>
<li><p><strong>test_time_aug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, perform test-time augmentation.</p></li>
<li><p><strong>da_transform_name</strong> (<em>str</em><em>, </em><em>optional</em>) – If provided, performs domain adaptation transform on test images, by
default None. Must be one of (“fda”, “hm”).</p></li>
<li><p><strong>overwrite_existing</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True and prediction file already exists, overwrite existing, by
default OVERWRITE_EXISTING.</p></li>
<li><p><strong>overwrite_hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to overwrite experiment hyperparameters</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If <cite>exp_name</cite> does not lead to a valid training directory</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.init">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.init" title="Link to this definition"></a></dt>
<dd><p>Initialize ArgumentParser</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parser</strong> (<em>argparse.ArgumentParser</em>) – ArgumentParser object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.load_image">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">load_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_numpy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">transform_hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#load_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.load_image" title="Link to this definition"></a></dt>
<dd><p>Load image as tensor or numpy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_path</strong> (<em>str</em>) – Path to image</p></li>
<li><p><strong>as_numpy</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return numpy array, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded and transformed image (images, if transform returns multiple images)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor or np.ndarray (if as_numpy)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.load_side_plane_view_predictions">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">load_side_plane_view_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">side_exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane_exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_bladder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#load_side_plane_view_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.load_side_plane_view_predictions" title="Link to this definition"></a></dt>
<dd><p>Load view label predictions for side and plane model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>side_exp_name</strong> (<em>str</em>) – Name of side experiment</p></li>
<li><p><strong>plane_exp_name</strong> (<em>str</em>) – Name of plane experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em>) – Name of evaluation split or test dataset</p></li>
<li><p><strong>mask_bladder</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, bladder predictions are masked out, by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains view label predictions (side and plane) for dataset</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.load_view_predictions">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">load_view_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">infer_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#load_view_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.load_view_predictions" title="Link to this definition"></a></dt>
<dd><p>Load predictions by model given by <cite>exp_name</cite> on dataset <cite>dset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em>) – Name of evaluation split or test dataset</p></li>
<li><p><strong>**infer_kwargs</strong> (<em>Keyword arguments which includes:</em>) – <dl class="simple">
<dt>mask_bladder<span class="classifier">bool, optional</span></dt><dd><p>If True, bladder predictions are masked out, by default False</p>
</dd>
<dt>test_time_aug<span class="classifier">bool, optional</span></dt><dd><p>If True, perform test-time augmentation.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Each row is an image with a view label (plane/side) predicted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.main">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.main" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Run main flows to:</dt><dd><ol class="arabic simple">
<li><p>Perform inference</p></li>
<li><p>Analyze predictions</p></li>
</ol>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.multi_predict_on_sequences">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">multi_predict_on_sequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/hpf/largeprojects/ccmbio/shua/data/ViewLabeling/Images/all_lab_img/'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#multi_predict_on_sequences"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.multi_predict_on_sequences" title="Link to this definition"></a></dt>
<dd><p>Performs inference on a full ultrasound sequence specified with a
multi-output model. Returns predictions, probabilities and raw model output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – A trained multi-output model (EfficientNetLSTMMulti).</p></li>
<li><p><strong>filenames</strong> (<em>np.array</em><em> or </em><em>array-like</em>) – Filenames (or full paths) to images from one unique sequence to infer.</p></li>
<li><p><strong>img_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to directory containing images, by default constants.DSET_TO_IMG_SUBDIR_FULL[“sickkids”]</p></li>
<li><p><strong>hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for experiment hyperparameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>For each frame in the sequence and for each side, contains</dt><dd><ul class="simple">
<li><p>prediction for each image,</p></li>
<li><p>probability of each prediction,</p></li>
<li><p>raw model output</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.plot_acc_over_sequence">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">plot_acc_over_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_seq_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#plot_acc_over_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.plot_acc_over_sequence" title="Link to this definition"></a></dt>
<dd><p>Plots accuracy of predictions over each number in the sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>update_seq_num</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, accounts for missing images between sequence numbers by
creating new (raw) sequence number based on existing images, by default
False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.plot_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">plot_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_confident</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#plot_confusion_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.plot_confusion_matrix" title="Link to this definition"></a></dt>
<dd><p>Plot confusion matrix based on model predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions and labels. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>filter_confident</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, filters for most confident prediction in each view label for
each unique sequence, before creating the confusion matrix.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.Axis</em><em>, </em><em>optional</em>) – Axis to plot confusion matrix on</p></li>
<li><p><strong>hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for experiment hyperparameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.plot_image_count_over_sequence">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">plot_image_count_over_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_seq_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#plot_image_count_over_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.plot_image_count_over_sequence" title="Link to this definition"></a></dt>
<dd><p>Plots number of imgaes for each number in the sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.plot_pred_probability_by_views">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">plot_pred_probability_by_views</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#plot_pred_probability_by_views"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.plot_pred_probability_by_views" title="Link to this definition"></a></dt>
<dd><p>Plot average probability of prediction per view label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>relative_side</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, assumes predicted labels are encoded for relative sides, by
default False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.plot_prob_over_sequence">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">plot_prob_over_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_seq_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#plot_prob_over_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.plot_prob_over_sequence" title="Link to this definition"></a></dt>
<dd><p>Plots average probability of prediction over each number in the sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>correct_only</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, filters for correctly predicted samples before plotting, by
default False.</p></li>
<li><p><strong>update_seq_num</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, accounts for missing images between sequence numbers by
creating new (raw) sequence number based on existing images, by default
False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.plot_rolling_accuracy">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">plot_rolling_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_seq_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_seq_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#plot_rolling_accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.plot_rolling_accuracy" title="Link to this definition"></a></dt>
<dd><p>Given predictions on ultrasound image sequences, plot accuracy on
overlapping windows of size <cite>window_size</cite>, based on sequence number.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Windows are done on sequence numbers (e.g., sequence numbers [0-14])</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>window_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Window size for sequence numbers, by default 15</p></li>
<li><p><strong>max_seq_num</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum sequence number to consider, by default 75</p></li>
<li><p><strong>update_seq_num</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, accounts for missing images between sequence numbers by
creating new (raw) sequence number based on existing images, by default
False.</p></li>
<li><p><strong>save_path</strong> (<em>str</em><em>, </em><em>optional</em>) – If provided, saves figure to path, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axis plot</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.predict_on_images">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">predict_on_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/hpf/largeprojects/ccmbio/shua/data/ViewLabeling/Images/all_lab_img/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_bladder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_time_aug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">da_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#predict_on_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.predict_on_images" title="Link to this definition"></a></dt>
<dd><p>Performs inference on images specified. Returns predictions, probabilities
and raw model output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – A trained PyTorch model.</p></li>
<li><p><strong>filenames</strong> (<em>np.array</em><em> or </em><em>array-like</em>) – Filenames (or full paths) to images to infer on.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em> of </em><em>str</em>) – String label for each image</p></li>
<li><p><strong>img_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to directory containing images, by default constants.DSET_TO_IMG_SUBDIR_FULL[“sickkids”]</p></li>
<li><p><strong>mask_bladder</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, mask out predictions on bladder/middle side, leaving only
kidney labels. Defaults to False.</p></li>
<li><p><strong>test_time_aug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, perform test-time augmentation.</p></li>
<li><p><strong>da_transform</strong> (<em>A.Compose</em><em>, </em><em>optional</em>) – If provided, contains Domain Adaptation transform and ensures it’s
converted back to a PyTorch tensor, by default None.</p></li>
<li><p><strong>hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for experiment hyperparameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>For each image, contains</dt><dd><ul class="simple">
<li><p>prediction for each image,</p></li>
<li><p>probability of each prediction,</p></li>
<li><p>raw model output</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.predict_on_sequences">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">predict_on_sequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/hpf/largeprojects/ccmbio/shua/data/ViewLabeling/Images/all_lab_img/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_bladder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_time_aug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#predict_on_sequences"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.predict_on_sequences" title="Link to this definition"></a></dt>
<dd><p>Performs inference on a full ultrasound sequence specified. Returns
predictions, probabilities and raw model output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – A trained PyTorch model.</p></li>
<li><p><strong>filenames</strong> (<em>np.array</em><em> or </em><em>array-like</em>) – Filenames (or full paths) to images from one unique sequence to infer.</p></li>
<li><p><strong>img_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to directory containing images, by default constants.DSET_TO_IMG_SUBDIR_FULL[“sickkids”]</p></li>
<li><p><strong>mask_bladder</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, mask out predictions on bladder/middle side, leaving only
kidney labels. Defaults to False.</p></li>
<li><p><strong>hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for experiment hyperparameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>For each frame in the sequence, contains</dt><dd><ul class="simple">
<li><p>prediction for each image,</p></li>
<li><p>probability of each prediction,</p></li>
<li><p>raw model output</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.print_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">print_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#print_confusion_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.print_confusion_matrix" title="Link to this definition"></a></dt>
<dd><p>Prints confusion matrix with proportion and count</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pandas.DataFrame</em>) – Model predictions and labels. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for experiment hyperparameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.scale_and_round">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">scale_and_round</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_places</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#scale_and_round"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.scale_and_round" title="Link to this definition"></a></dt>
<dd><p>Scale and round if value is an integer or float.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Any</em>) – Any object</p></li>
<li><p><strong>factor</strong> (<em>int</em>) – Factor to multiply by</p></li>
<li><p><strong>num_places</strong> (<em>int</em>) – Number of decimals to round</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.show_example_side_predictions">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">show_example_side_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_part</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#show_example_side_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.show_example_side_predictions" title="Link to this definition"></a></dt>
<dd><p>Given label sequences and their corresponding side predictions (encoded as
single characters), print full label and prediction sequences with incorrect
predictions colored red.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_pred</strong> (<em>pd.DataFrame</em>) – Model predictions. Each row contains a label,
prediction, and other patient and sequence-related metadata.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – Number of random unique sequences to show</p></li>
<li><p><strong>relative_side</strong> (<em>bool</em>) – If True, predicted labels must be relative side (e.g., Transverse_First)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.store_example_classifications">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">store_example_classifications</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_bladder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/hpf/largeprojects/ccmbio/shua/projects/view_hn/src/data/figures/predictions/'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#store_example_classifications"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.store_example_classifications" title="Link to this definition"></a></dt>
<dd><p>Store correctly/incorrectly classified images in nested folders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em>) – Name of evaluation split or test dataset</p></li>
<li><p><strong>hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Experiment hyperparameters, by default None</p></li>
<li><p><strong>mask_bladder</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, bladder predictions are masked out, by default False</p></li>
<li><p><strong>save_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory to save model classifications, by default
constants.DIR_FIGURES_PRED</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_eval.transform_image">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_eval.</span></span><span class="sig-name descname"><span class="pre">transform_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_eval.html#transform_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_eval.transform_image" title="Link to this definition"></a></dt>
<dd><p>Transforms image, as done during training.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Transforms include:</dt><dd><ul class="simple">
<li><p>Resize the image to (256, 256)</p></li>
</ul>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>np.array</em>) – An image</p></li>
<li><p><strong>augment</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, perform augmentations during training</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – If augmenting, the number of times to randomly augment the image</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed image/s with extra first dimension, useful if n &gt; 1.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.scripts.model_training">
<span id="src-scripts-model-training-module"></span><h2>src.scripts.model_training module<a class="headerlink" href="#module-src.scripts.model_training" title="Link to this heading"></a></h2>
<p>model_training.py</p>
<p>Description: Used to train PyTorch models.</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_training.main">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_training.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_training.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_training.main" title="Link to this definition"></a></dt>
<dd><p>Main method to run experiments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conf</strong> (<em>configobj.ConfigObj</em>) – Contains configurations needed to run experiments</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_training.run">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_training.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_training.html#run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_training.run" title="Link to this definition"></a></dt>
<dd><p>Perform (1) model training, and/or (2) load model and perform testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hparams</strong> (<em>dict</em>) – Contains (data-related, model-related) setup parameters for training and
testing</p></li>
<li><p><strong>dm</strong> (<em>L.LightningDataModule</em>) – Data module, which already called .setup()</p></li>
<li><p><strong>results_dir</strong> (<em>str</em>) – Path to directory containing trained model and/or test results</p></li>
<li><p><strong>train</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, trains a model and saves it to results_dir, by default True</p></li>
<li><p><strong>test</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, performs evaluation on trained/existing model and saves results
to results_dir, by default True</p></li>
<li><p><strong>fold</strong> (<em>int</em><em>, </em><em>optional</em>) – If performing cross-validation, supplies fold index. Index ranges
between 0 to (num_folds - 1). If train-val-test split, remains 0, by
default 0.</p></li>
<li><p><strong>swa</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, perform Stochastic Weight Averaging (SWA), by default True.</p></li>
<li><p><strong>checkpoint</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, saves model (last epoch) to checkpoint, by default True</p></li>
<li><p><strong>early_stopping</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, performs early stopping on plateau of val loss, by default
False.</p></li>
<li><p><strong>exp_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of experiment, by default “1”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.model_training.set_seed">
<span class="sig-prename descclassname"><span class="pre">src.scripts.model_training.</span></span><span class="sig-name descname"><span class="pre">set_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_algos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/model_training.html#set_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.model_training.set_seed" title="Link to this definition"></a></dt>
<dd><p>Set random seed for all models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed. If None, don’t set seed, by default SEED</p></li>
<li><p><strong>include_algos</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, forces usage of deterministic algorithms at the cost of
performance, by default False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.scripts.ssl_model_eval">
<span id="src-scripts-ssl-model-eval-module"></span><h2>src.scripts.ssl_model_eval module<a class="headerlink" href="#module-src.scripts.ssl_model_eval" title="Link to this heading"></a></h2>
<p>ssl_model_eval.py</p>
<dl class="simple">
<dt>Description: Used to automatically evaluate a SSL-trained model by</dt><dd><ol class="arabic simple">
<li><p>Training a Linear model on side and plane, separately</p></li>
<li><p>Training a LSTM + Linear model on side and plane, separately</p></li>
<li><p>Evaluate each of the 4+ models</p></li>
</ol>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.ssl_model_eval.analyze_eval_model_preds">
<span class="sig-prename descclassname"><span class="pre">src.scripts.ssl_model_eval.</span></span><span class="sig-name descname"><span class="pre">analyze_eval_model_preds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear_lstm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_part</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'side'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freeze_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment_training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lp_ft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/ssl_model_eval.html#analyze_eval_model_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.ssl_model_eval.analyze_eval_model_preds" title="Link to this definition"></a></dt>
<dd><p>Evaluate single evaluation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Name of SSL experiment</p></li>
<li><p><strong>dset</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Name of evaluation split / dataset to perform inference on, by default
constants.DEFAULT_EVAL_SPLIT</p></li>
<li><p><strong>model_type</strong> (<em>str</em><em>, </em><em>optional</em>) – One of (“linear”, “linear_lstm”), by default “linear_lstm”</p></li>
<li><p><strong>label_part</strong> (<em>str</em><em>, </em><em>optional</em>) – One of (“side”, “plane”), by default “side”</p></li>
<li><p><strong>freeze_weights</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, freezes convolutional weights during training, by default False</p></li>
<li><p><strong>augment_training</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, adds augmentation during linear probing / fine-tuning, by
default False</p></li>
<li><p><strong>lp_ft</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, trains eval. model via fine-tuning starting FROM an eval. model
that was created via linear probing, by default False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.ssl_model_eval.analyze_preds">
<span class="sig-prename descclassname"><span class="pre">src.scripts.ssl_model_eval.</span></span><span class="sig-name descname"><span class="pre">analyze_preds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment_training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/ssl_model_eval.html#analyze_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.ssl_model_eval.analyze_preds" title="Link to this definition"></a></dt>
<dd><p>Perform test prediction analysis from <cite>model_eval</cite> on trained evaluations
models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Base SSL experiment name</p></li>
<li><p><strong>augment_training</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, check evaluation models fine-tuned WITH augmentation, by
default False.</p></li>
<li><p><strong>dset</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Name of evaluation split / dataset to perform inference on, by default
constants.DEFAULT_EVAL_SPLIT</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.ssl_model_eval.find_best_ckpt_path">
<span class="sig-prename descclassname"><span class="pre">src.scripts.ssl_model_eval.</span></span><span class="sig-name descname"><span class="pre">find_best_ckpt_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_exp_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/ssl_model_eval.html#find_best_ckpt_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.ssl_model_eval.find_best_ckpt_path" title="Link to this definition"></a></dt>
<dd><p>Finds the path to the best model checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path_exp_dir</strong> (<em>str</em>) – Path to a trained model directory</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to PyTorch Lightning best model checkpoint</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If no valid ckpt files found</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.ssl_model_eval.init">
<span class="sig-prename descclassname"><span class="pre">src.scripts.ssl_model_eval.</span></span><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/ssl_model_eval.html#init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.ssl_model_eval.init" title="Link to this definition"></a></dt>
<dd><p>Initialize ArgumentParser</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parser</strong> (<em>argparse.ArgumentParser</em>) – ArgumentParser object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.ssl_model_eval.main">
<span class="sig-prename descclassname"><span class="pre">src.scripts.ssl_model_eval.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/ssl_model_eval.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.ssl_model_eval.main" title="Link to this definition"></a></dt>
<dd><p>Perform evaluation of SSL model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_names</strong> (<em>list</em>) – List of experiments to evaluate</p></li>
<li><p><strong>dsets</strong> (<em>list</em>) – List of datasets to evaluate</p></li>
<li><p><strong>hparams</strong> (<em>dict</em>) – Arguments for training SSL evaluation model</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.ssl_model_eval.prep_eval_exp_hparams">
<span class="sig-prename descclassname"><span class="pre">src.scripts.ssl_model_eval.</span></span><span class="sig-name descname"><span class="pre">prep_eval_exp_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overwrite_hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/ssl_model_eval.html#prep_eval_exp_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.ssl_model_eval.prep_eval_exp_hparams" title="Link to this definition"></a></dt>
<dd><p>Prepare hyperparameters for training SSL linear probe / fine-tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hparams</strong> (<em>dict</em>) – Contains all hyperparameters of the experiment</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated dictionary of hyperparameters for SSL eval model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.ssl_model_eval.train_eval_model">
<span class="sig-prename descclassname"><span class="pre">src.scripts.ssl_model_eval.</span></span><span class="sig-name descname"><span class="pre">train_eval_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/ssl_model_eval.html#train_eval_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.ssl_model_eval.train_eval_model" title="Link to this definition"></a></dt>
<dd><p>Train single evaluation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hparams</strong> (<em>dict</em>) – Contains updated hyperparameters to train SSL-eval model. Arguments
will be passed into <cite>model_training.main</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scripts.ssl_model_eval.train_eval_models">
<span class="sig-prename descclassname"><span class="pre">src.scripts.ssl_model_eval.</span></span><span class="sig-name descname"><span class="pre">train_eval_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overwrite_hparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/scripts/ssl_model_eval.html#train_eval_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.scripts.ssl_model_eval.train_eval_models" title="Link to this definition"></a></dt>
<dd><p>Train all possible evaluation models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<em>str</em>) – Base SSL experiment name</p></li>
<li><p><strong>**overwrite_hparams</strong> (<em>dict</em><em>, </em><em>optional</em>) – Hyperparameters to overwrite SSL training hyperparams to pass into
<cite>model_training.main()</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.scripts">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-src.scripts" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="src.models.html" class="btn btn-neutral float-left" title="src.models package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="src.utils.html" class="btn btn-neutral float-right" title="src.utils package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Stanley Hua.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>